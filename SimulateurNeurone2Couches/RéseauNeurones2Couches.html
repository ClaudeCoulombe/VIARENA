<!DOCTYPE html>
<html>
  <!-- Travail original en JavaScript par John Fisher https://github.com/jg-fisher/perceptron -->
  <!-- Également inspiré par Petro Liashchynskyi: https://github.com/liashchynskyi/skynet/ -->
  <!-- et Andrew Trask: https://iamtrask.github.io/2015/07/12/basic-python-network/ -->
  <!-- Refactorisation et améliorations de Claude COULOMBE -->
  <head>
    <title>Réseau de neurones à deux couches</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <hr>
    <!-- https://www.w3schools.com/howto/howto_css_two_columns.asp -->
    <fieldset id="simulateur">
      <legend id="titre_simulateur">Simulation d'un réseau de neurones à deux couches</legend>
      <br>
      <div class="parent">
          <div>
            <img class="reseau_neurones" width=1000 src="RéseauNeurones2Couches.png"/>
            <span id="infobulle_biais_nc1" class="infobulle">
              <button id="biais_nc1" class="biais" type="button">
                <img id="image_biais" src="https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@biais.png">
              </button>
              <span class="infobulletexte">Biais du neurone cach&eacute; 1, fix&eacute; &agrave; 1.0</span>
            </span>
            <label id="affichage_entree_biais_nc1_0" class="affichage_entree_0" for="0">0</label>
            <input id="entree_biais_nc1_0" class="entree_0" type="radio" disabled
            name="entree_biais_nc1_0" value='0' onclick="entrer_valeur_dattribut(this.id)">
            <label id="affichage_entree_biais_nc1_1" class="affichage_entree_1" for="1">1</label>
            <input id="entree_biais_nc1_1" class="entree_1" type="radio" checked="checked"
            name="entree_biais_nc1_1" value='1' onclick="entrer_valeur_dattribut(this.id)">   
            <span id="infobulle_glissiere_poids_biais_nc1" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_biais_nc1" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_biais_nc1">0.00</span>
              </span>
              <span class="infobulletexte">Poids du biais du neurone cach&eacute; 1</span>
            </span>
            <span id="infobulle_entree1" class="infobulle">
              <span>
                <img id="image_entree1" src="https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@entree.png"/>
                <label id="affichage_entree1_0" for="0">0</label>
                <input id="entree1_0" class="entree_0" type="radio" 
                       name="entree1_0" value='0' onclick="entrer_valeur_dattribut(this.id)">
                <label id="affichage_entree1_1" for="1">1</label>
                <input id="entree1_1" class="entree_1" type="radio" 
                     name="entree1_1" value='1' onclick="entrer_valeur_dattribut(this.id)">          
              </span>
              <span class="infobulletexte">Entr&eacute;e ou attribut no 1</span>
            </span>
            <span id="infobulle_glissiere_poids_entree1_nc1" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_entree1_nc1" class="glissiere_poids" type="range" min="-100" max="100" value="0">
                <span id="affichage_glissiere_poids_entree1_nc1">0.00</span>
              </span>
              <span class="infobulletexte">Poids de l'entr&eacute;e 1 du neurone cach&eacute; 1</span>
            </span>
            <span id="infobulle_glissiere_poids_entree2_nc1" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_entree2_nc1" class="glissiere_poids" type="range" min="-100" max="100" value="0">
                <span id="affichage_glissiere_poids_entree2_nc1">0.00</span>
              </span>
              <span class="infobulletexte">Poids de l'entr&eacute;e 2 du neurone cach&eacute; 1</span>
            </span>
            <span id="infobulle_entree2" class="infobulle">
              <span>
                <img id="image_entree2" src="https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@entree.png"/>
                <label id="affichage_entree2_0" for="0">0</label>
                <input id="entree2_0" class="entree_0" type="radio" 
                       name="entree2_0" value='0' onclick="entrer_valeur_dattribut(this.id)">
                <label id="affichage_entree2_1" for="1">1</label>
                <input id="entree2_1" class="entree_1" type="radio" 
                     name="entree2_1" value='1' onclick="entrer_valeur_dattribut(this.id)">          
              </span>
              <span class="infobulletexte">Entr&eacute;e ou attribut no 2</span>
            </span>
            <span id="infobulle_glissiere_poids_entree1_nc2" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_entree1_nc2" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_entree1_nc2">0.00</span>
              </span>
              <span class="infobulletexte">Poids de l'entr&eacute;e 1 du neurone cach&eacute; 2</span>
            </span>
            <span id="infobulle_glissiere_poids_entree2_nc2" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_entree2_nc2" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_entree2_nc2">0.00</span>
              </span>
              <span class="infobulletexte">Poids de l'entr&eacute;e 2 du neurone cach&eacute; 2</span>
            </span>
            <span id="infobulle_biais_nc2" class="infobulle">
              <button id="biais_nc2" class="biais" type="button">
                <img id="image_biais" src="https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@biais.png">
              </button>
              <span class="infobulletexte">Biais du neurone cach&eacute; no 2, fix&eacute; &agrave; 1.0</span>
            </span>
            <label id="affichage_entree_biais_nc2_0" class="affichage_entree_0" for="0">0</label>
            <input id="entree_biais_nc2_0" class="entree_0" type="radio" disabled
            name="entree_biais_nc2_0" value='0' onclick="entrer_valeur_dattribut(this.id)">
            <label id="affichage_entree_biais_nc2_1" class="affichage_entree_1" for="1">1</label>
            <input id="entree_biais_nc2_1" class="entree_1" type="radio" checked="checked"
            name="entree_biais_nc2_1" value='1' onclick="entrer_valeur_dattribut(this.id)">   
            <span id="infobulle_glissiere_poids_biais_nc2" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_biais_nc2" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_biais_nc2">0.00</span>
              </span>
              <span class="infobulletexte">Poids du biais du neurone cach&eacute; 2.</span>
            </span>
            <span id="infobulle_glissiere_poids_entree1_ns" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_entree1_ns" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_entree1_ns">0.00</span>
              </span>
              <span class="infobulletexte">Poids de l'entr&eacute;e 1 du neurone de sortie.</span>
            </span>   
            <span id="infobulle_biais_ns" class="infobulle">
              <button id="biais_ns" class="biais" type="button">
                <img id="image_biais" src="https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@biais.png">
              </button>
              <span class="infobulletexte">Biais du neurone de sortie, fix&eacute; &agrave; 1.0</span>
            </span>
            <label id="affichage_entree_biais_ns_0" class="affichage_entree_0" for="0">0</label>
            <input id="entree_biais_ns_0" class="entree_0" type="radio" disabled
            name="entree_biais_ns_0" value='0' onclick="entrer_valeur_dattribut(this.id)">
            <label id="affichage_entree_biais_ns_1" class="affichage_entree_1" for="1">1</label>
            <input id="entree_biais_ns_1" class="entree_1" type="radio" checked="checked"
            name="entree_biais_ns_1" value='1' onclick="entrer_valeur_dattribut(this.id)">   
            <span id="infobulle_glissiere_poids_biais_ns" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_biais_ns" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_biais_ns">0.00</span>
              </span>
              <span class="infobulletexte">Poids du biais du neurone de sortie.</span>
            </span> 
            <span id="infobulle_glissiere_poids_entree2_ns" class="infobulle">
              <span class="contenant_glissiere">
                <input id="glissiere_poids_entree2_ns" class="glissiere_poids" type="range" min="-100" max="100" value="0" >
                <span id="affichage_glissiere_poids_entree2_ns">0.00</span>
              </span>
              <span class="infobulletexte">Poids de l'entr&eacute;e 2 du neurone de sortie.</span>
              <img id="declenchement" src="https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@declenchement.png">
            </span>            
          </div>
          <div>
            <input type="button" id="bouton_demarrer" value="Simuler" onclick="demarrer_simulateur()"</input>
          </div>
      </div>
      <br>
      <fieldset id="afficheur_calcul_du_neurone">
        <legend id="titre_afficheur">Calcul fait par le réseau de neurones à deux couches</legend>
        <label id="affichage_du_calcul"></label>
      </fieldset>
      </div>
    </fieldset>
<!--    <div id="anim"></div> -->
  <script>

        class Neurone {
          constructor(donnees_entree, poids_donnees_entree, biais=1, poids_biais=1.0, fn_activation='echelon') {
            this.donnees_entree = donnees_entree;
            if (poids_donnees_entree) {
              this.poids_donnees_entree = poids_donnees_entree;
            } else {
              // Initialiser avec des poids choisis aléatoirement
              this.poids_donnees_entree = new Array(donnees_entree.length)
              for ( let i = 0; i < donnees_entree.length; i++ ) {
                this.poids_donnees_entree[i] = nombreAleatoire() * 2 - 1;
              }
            }
            this.biais = biais;
            this.poids_biais = poids_biais;
            this.somme_ponderee_donnees_entree = 0.0;
            this.fn_activation = fn_activation;
            this.neurone_actif = false;
            this.resultat_activation = 0.0;
            this.calcul_a_afficher = "";
            // this.afficher();
          } 
          afficher(indicateur=true){
            if (indicateur) {
              afficherMessage("");
              afficherMessage("Etat du Neurone");
              afficherMessage("donnees_entree: "+this.donnees_entree);
              afficherMessage("poids_donnees_entree: "+this.poids_donnees_entree);
              afficherMessage("biais: "+this.biais);
              afficherMessage("poids_biais: "+this.poids_biais);
              afficherMessage("somme_ponderee_donnees_entree: "+this.somme_ponderee_donnees_entree);
              afficherMessage("fn_activation: "+this.fn_activation);
              afficherMessage("neurone_actif: "+this.neurone_actif);
              afficherMessage("resultat_activation: "+this.resultat_activation);
              afficherMessage("calcul_a_afficher: "+this.calcul_a_afficher);
              afficherMessage("");
            }
          }
          // Fonctions d'activation https://en.wikipedia.org/wiki/Activation_function
          // Échelon ou échelon binaire (en anglais, binary step)     
          echelon(x) {
              return x < 0 ? 0 : 1;
          }
          // Courbe en S verticale entre 0 et +1 
          // Appelée fonction sigmoïde ou fonction logistique
          sigmoide(x) {
            return (1/(1 + Math.pow(Math.E, -x)));
          }
          // Fonction tanh ou tangente_hyperbolique
          tangente_hyperbolique(x) {
            return Math.tanh(x);
          }
          // Fonction ReLU (Rectified Linear Unit)
          relu(x) {
            return (x <= 0) ? 0 : x;
          }
          // Fonction sommation - somme ponderée des entrées
          somme_ponderee() {
            var somme_ponderee_donnees_entree = this.biais*this.poids_biais;
            this.poids_donnees_entree.forEach((poids, index) => 
              { somme_ponderee_donnees_entree += this.donnees_entree[index] * poids });
            this.somme_ponderee_donnees_entree = somme_ponderee_donnees_entree;
            return this.somme_ponderee_donnees_entree;
          }
          activation_neurone() {
            this.calcul_a_afficher = "";
            var x = this.somme_ponderee_donnees_entree;
            switch(this.fn_activation) {
              case "echelon":
                this.resultat_activation = this.echelon(x);
                this.calcul_a_afficher = "&eacute;chelon( "+ arrondir(x) + " ) = " + arrondir(this.resultat_activation,2);
                this.calcul_a_afficher += " - Activation: &Eacute;chelon, entre 0 et +1, avec un seuil de d&eacute;clenchement &agrave; z&eacute;ro";
                if (this.resultat_activation > 0.0) {
                  this.calcul_a_afficher += " - Notez que le neurone est 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = true;
                } else {
                  this.calcul_a_afficher += " - Notez que le neurone n'est pas 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = false;
                }
                break;
              case "sigmoide":
                this.resultat_activation = this.sigmoide(x);
                this.calcul_a_afficher = "sigmo"+"&iuml;"+"de( "+ arrondir(x,2) + " ) = " + arrondir(this.resultat_activation,2);
                this.calcul_a_afficher += " - Activation: Courbe en S positive, entre 0 et +1, ou sigmo&iuml;de, ou fonction logistique, avec un seuil de d&eacute;clenchement &agrave; 0.5";
                if (this.resultat_activation > 0.5) {
                  this.calcul_a_afficher += " - Notez que le neurone est 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = true;
                } else {
                  this.calcul_a_afficher += " - Notez que le neurone n'est pas 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = false;
                }
                break;
              case "tanh":
                this.resultat_activation = this.tangente_hyperbolique(x); 
                this.calcul_a_afficher = "tanh( "+ arrondir(x,2) + " ) = " + arrondir(this.resultat_activation,2);
                this.calcul_a_afficher += " - Activation: Courbe en S centr&eacute;e sur z&eacute;ro, entre -1 et +1 ou tangente hyperbolique, avec un seuil de d&eacute;clenchement &agrave; z&eacute;ro";
                if (this.resultat_activation > 0.0) {
                  this.calcul_a_afficher += " - Notez que le neurone est 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = true;
                } else {
                  this.calcul_a_afficher += " - Notez que le neurone n'est pas 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = false;
                }
                break;
              case "relu":
                this.resultat_activation = this.relu(x);
                this.calcul_a_afficher = "relu( "+ arrondir(x,2) + " ) = " + arrondir(this.resultat_activation,2);
                this.calcul_a_afficher += " - Activation: Rampe droite &agrave; 45 degr&eacute; ou unit&eacute lin&eacute;aire rectifi&eacute;e, en anglais ReLU, avec un seuil de d&eacute;clenchement &agrave; z&eacute;ro";
                if (this.resultat_activation > 0.0) {
                  this.calcul_a_afficher += " - Notez que le neurone est 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = true;
                } else {
                  this.calcul_a_afficher += " - Notez que le neurone n'est pas 'd&eacute;clench&eacute;'.";
                  this.neurone_actif = false;
                }
                break;
              default:
                this.resultat_activation = "ERREUR";
            }
            return this.resultat_activation;
          }
        }

        // Nombre aleatoire entre 0 et 1
        function nombreAleatoire() {
            return Math.random(); 
        }

        function arrondir(num, precision=2) {
          var base = 10 ** precision;
          return (Math.round(num * base) / base).toFixed(precision);
        }

        function afficherMessage(message,indicateur=true) {
          if (indicateur) {
            var element = document.createElement('strong');
            element.innerHTML = message + '<br/>';
            document.body.appendChild(element);
          }
        }

        var sortie_affichage_calcul = document.getElementById('affichage_du_calcul');
        var sortie_activation = document.getElementById('affichage_activation');
        var calcul_a_afficher = ""

        document.getElementById("declenchement").style.visibility = "hidden";

        var entree_biais_nc1 = 1.0
        var entree_biais_nc2 = 1.0
        var entree_biais_ns = 1.0
        var entree1 = 0.0
        var entree2 = 0.0

        function entrer_valeur_dattribut(bouton_id) {
          // alert("bouton_id="+bouton_id)
          switch(bouton_id) {
            case "entree1_0":
              entree1 = 0.0;
              document.getElementById('entree1_1').checked = false;
              break;
            case "entree1_1":
              entree1 = 1.0;
              document.getElementById('entree1_0').checked = false;
              break;
            case "entree2_0":
              entree2 = 0.0;
              document.getElementById('entree2_1').checked = false;
              break;
            case "entree2_1":
              entree2 = 1.0;
              document.getElementById('entree2_0').checked = false;
              break;
            default:
              nope;
          }
        }

        // Code des glissière servant à entrer les poids
        var glissiere_poids_biais_nc1 = document.getElementById("glissiere_poids_biais_nc1");
        var affichage_glissiere_poids_biais_nc1 = document.getElementById("affichage_glissiere_poids_biais_nc1");
        var poids_biais_nc1 = parseFloat(document.getElementById("affichage_glissiere_poids_biais_nc1").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_biais_nc1.innerHTML = poids_biais_nc1.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_biais_nc1.oninput = function() {
          poids_biais_nc1 = (glissiere_poids_biais_nc1.value/100).toFixed(2);
          affichage_glissiere_poids_biais_nc1.textContent = poids_biais_nc1; 
        }

        var glissiere_poids_entree1_nc1 = document.getElementById("glissiere_poids_entree1_nc1");
        var affichage_glissiere_poids_entree1_nc1 = document.getElementById("affichage_glissiere_poids_entree1_nc1");
        var poids_entree1_nc1 = parseFloat(document.getElementById("affichage_glissiere_poids_entree1_nc1").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_entree1_nc1.innerHTML = poids_entree1_nc1.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_entree1_nc1.oninput = function() {
          poids_entree1_nc1 = (glissiere_poids_entree1_nc1.value/100).toFixed(2);
          affichage_glissiere_poids_entree1_nc1.textContent = poids_entree1_nc1; 
        }

        var glissiere_poids_entree2_nc1 = document.getElementById("glissiere_poids_entree2_nc1");
        var affichage_glissiere_poids_entree2_nc1 = document.getElementById("affichage_glissiere_poids_entree2_nc1");
        var poids_entree2_nc1 = parseFloat(document.getElementById("affichage_glissiere_poids_entree2_nc1").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_entree2_nc1.innerHTML = poids_entree2_nc1.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_entree2_nc1.oninput = function() {
          poids_entree2_nc1 = (glissiere_poids_entree2_nc1.value/100).toFixed(2);
          affichage_glissiere_poids_entree2_nc1.textContent = poids_entree2_nc1; 
        }

        var glissiere_poids_entree1_nc2 = document.getElementById("glissiere_poids_entree1_nc2");
        var affichage_glissiere_poids_entree1_nc2 = document.getElementById("affichage_glissiere_poids_entree1_nc2");
        var poids_entree1_nc2 = parseFloat(document.getElementById("affichage_glissiere_poids_entree1_nc2").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_entree1_nc2.innerHTML = poids_entree1_nc2.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_entree1_nc2.oninput = function() {
          poids_entree1_nc2 = (glissiere_poids_entree1_nc2.value/100).toFixed(2);
          affichage_glissiere_poids_entree1_nc2.textContent = poids_entree1_nc2; 
        }

        var glissiere_poids_entree2_nc2 = document.getElementById("glissiere_poids_entree2_nc2");
        var affichage_glissiere_poids_entree2_nc2 = document.getElementById("affichage_glissiere_poids_entree2_nc2");
        var poids_entree2_nc2 = parseFloat(document.getElementById("affichage_glissiere_poids_entree2_nc2").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_entree2_nc2.innerHTML = poids_entree2_nc2.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_entree2_nc2.oninput = function() {
          poids_entree2_nc2 = (glissiere_poids_entree2_nc2.value/100).toFixed(2);
          affichage_glissiere_poids_entree2_nc2.textContent = poids_entree2_nc2; 
        }

        var glissiere_poids_biais_nc2 = document.getElementById("glissiere_poids_biais_nc2");
        var affichage_glissiere_poids_biais_nc2 = document.getElementById("affichage_glissiere_poids_biais_nc2");
        var poids_biais_nc2 = parseFloat(document.getElementById("affichage_glissiere_poids_biais_nc2").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_biais_nc2.innerHTML = poids_biais_nc2.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_biais_nc2.oninput = function() {
          poids_biais_nc2 = (glissiere_poids_biais_nc2.value/100).toFixed(2);
          affichage_glissiere_poids_biais_nc2.textContent = poids_biais_nc2; 
        }

        var glissiere_poids_biais_ns = document.getElementById("glissiere_poids_biais_ns");
        var affichage_glissiere_poids_biais_ns = document.getElementById("affichage_glissiere_poids_biais_ns");
        var poids_biais_ns = parseFloat(document.getElementById("affichage_glissiere_poids_biais_ns").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_biais_ns.innerHTML = poids_biais_ns.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_biais_ns.oninput = function() {
          poids_biais_ns = (glissiere_poids_biais_ns.value/100).toFixed(2);
          affichage_glissiere_poids_biais_ns.textContent = poids_biais_ns; 
        }

        var glissiere_poids_entree1_ns = document.getElementById("glissiere_poids_entree1_ns");
        var affichage_glissiere_poids_entree1_ns = document.getElementById("affichage_glissiere_poids_entree1_ns");
        var poids_entree1_ns = parseFloat(document.getElementById("affichage_glissiere_poids_entree1_ns").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_entree1_ns.innerHTML = poids_entree1_ns.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_entree1_ns.oninput = function() {
          poids_entree1_ns = (glissiere_poids_entree1_ns.value/100).toFixed(2);
          affichage_glissiere_poids_entree1_ns.textContent = poids_entree1_ns; 
        }

        var glissiere_poids_entree2_ns = document.getElementById("glissiere_poids_entree2_ns");
        var affichage_glissiere_poids_entree2_ns = document.getElementById("affichage_glissiere_poids_entree2_ns");
        var poids_entree2_ns = parseFloat(document.getElementById("affichage_glissiere_poids_entree2_ns").innerHTML);
        // Afficher valeur par défaut de la glissiere
        affichage_glissiere_poids_entree2_ns.innerHTML = poids_entree2_ns.toFixed(2); 
        // Mise à jour de la sortie d'affichage de la glissiere
        glissiere_poids_entree2_ns.oninput = function() {
          poids_entree2_ns = (glissiere_poids_entree2_ns.value/100).toFixed(2);
          affichage_glissiere_poids_entree2_ns.textContent = poids_entree2_ns; 
        }

        var neurone_nc1_sortie = 0.0;
        var neurone_nc2_sortie = 0.0;
        var calcul_a_afficher = "";

        function demarrer_simulateur() {

          calcul_a_afficher = "";
          document.getElementById("declenchement").style.visibility = "hidden";

          var donnees_entree_nc1 = [entree1,entree2];
          calcul_a_afficher += "*** entr&eacute;e 1: " + entree1 + ", entr&eacute;e 2: " + entree2;
          var poids_donnees_entree_nc1 = [poids_entree1_nc1,poids_entree2_nc1];
          neurone_nc1 = new Neurone(donnees_entree_nc1, poids_donnees_entree_nc1, entree_biais_nc1, poids_biais_nc1, 'echelon');
          neurone_nc1.somme_ponderee();
          neurone_nc1_sortie = neurone_nc1.activation_neurone();
          calcul_a_afficher += " *** Neurone 1 couche cach&eacute;e: " + neurone_nc1.calcul_a_afficher;

          var donnees_entree_nc2 = [entree1,entree2];
          var poids_donnees_entree_nc2 = [poids_entree1_nc2,poids_entree2_nc2];
          neurone_nc2 = new Neurone(donnees_entree_nc2, poids_donnees_entree_nc2, entree_biais_nc2, poids_biais_nc2, 'echelon');
          neurone_nc2.somme_ponderee();
          neurone_nc2_sortie = neurone_nc2.activation_neurone();
          calcul_a_afficher += " *** Neurone 2 couche cach&eacute;e: " + neurone_nc2.calcul_a_afficher;

          var donnees_entree_ns = [neurone_nc1_sortie,neurone_nc2_sortie];
          var poids_donnees_entree_ns = [poids_entree1_ns,poids_entree2_ns];
          neurone_ns = new Neurone(donnees_entree_ns, poids_donnees_entree_ns, entree_biais_ns, poids_biais_ns, 'echelon');
          neurone_ns.somme_ponderee();
          neurone_ns_sortie = neurone_ns.activation_neurone();
          calcul_a_afficher += " *** Neurone couche sortie: " + neurone_ns.calcul_a_afficher + " ***"; 

          sortie_affichage_calcul.innerHTML = calcul_a_afficher;

          if (neurone_ns.neurone_actif) {
              document.getElementById("declenchement").style.visibility = "visible";
          } else {
              document.getElementById("declenchement").style.visibility = "hidden";
          }

        }

  </script>

  <style>

      /* 
         Couleur bordure: #3D85C6
         Remplissage: #CFE2F3FF
      */

      * {
        background-color: white; 
        border:none;
      }


      p {
        font-size: 150%;
      }

      li {
        font-size: 150%;
      }

      /* Create two columns that floats next to each other */
      /* Clear floats after the columns */

      #simulateur {
        border: 4px solid;
        border-radius: 10px;
        border-color: #3D85C6;
        width: 100%;
        min-width: 1580px;
        max-width: 1580px;
      }

      #titre_simulateur {
        font-weight: bold;
        font-size: 200%;
      }

      .reseau_neurones {
        position: relative;
        top: 13px;
        left: 48px;
        z-index: 0;
      }

/* biais neurone 1 */

      #infobulle_biais_nc1 {
        position: absolute;
        top: -25px;
        left:0px;
      }

      #biais_nc1 {
        position: absolute;
        height:30px;
        width:30px;
        top: 36px;
        left: -10px;
      }

      #image_biais {
      }

      #affichage_entree_biais_nc1_0 {
        position:absolute;
        color:#d1d1d1;
        top: 21px;
        left: 60px;
      }

      #entree_biais_nc1_0 {
        position:absolute;
        top: 20px;
        left: 70px;
      }

      #affichage_entree_biais_nc1_1 {
        position:absolute;
        color:#d1d1d1;
        top: 49px;
        left: 60px;
      }

      #entree_biais_nc1_1 {
        position:absolute;
        top: 48px;
        left: 70px;
      }

      #glissiere_poids_biais_nc1 {
        position:absolute;
        width: 135px;  
        top: 59px;
        left: -31px;
      }

      #affichage_glissiere_poids_biais_nc1 {
        position:absolute;
        top: 62px;
        left: 119px;
      }

      #infobulle_glissiere_poids_biais_nc1 {
        position: absolute;
        top: -27px;
        left:175px;
      }

/* entrée 1 */

      #infobulle_entree1 {
        position: absolute;
        top: 100px;
        left:10px;
     }

      #image_entree1 {
        position: absolute;
        height:60px;
        width:70px;
        top: 60px;
        left:-20px;
      }

      #affichage_entree1_0 {
        position:absolute;
        top: 66px;
        left: 52px;
      }

      #entree1_0 {
        position:absolute;
        top: 66px;
        left: 60px;
      }

      #affichage_entree1_1 {
        position:absolute;
        top: 94px;
        left: 52px;
      }

      #entree1_1 {
        position:absolute;
        top: 94px;
        left: 60px;
      }

      #glissiere_poids_entree1_nc1 {
        position:absolute;
        width: 135px;  
        top: 86px;
        left: -56px;
        z-index: 80;
      }

      #affichage_glissiere_poids_entree1_nc1 {
        position:absolute;
        top: 87px;
        left: -92px;
      }

      #infobulle_glissiere_poids_entree1_nc1 {
        position: absolute;
        top: 20px;
        left:200px;
      }

/* entrée 2 */

      #infobulle_entree2 {
        position: absolute;
        top: 200px;
        left:10px;
      }

      #image_entree2 {
        position: absolute;
        height:60px;
        width:70px;
        top: 52px;
        left:-20px;
      }

      #affichage_entree2_0 {
        position:absolute;
        top: 60px;
        left: 52px;
      }

      #entree2_0 {
        position:absolute;
        top: 60px;
        left: 60px;
      }

      #affichage_entree2_1 {
        position:absolute;
        top: 88px;
        left: 52px;
      }

      #entree2_1 {
        position:absolute;
        top: 88px;
        left: 60px;
      }

      #glissiere_poids_entree2_nc1 {
        position:absolute;
        width: 135px;  
        top: 72px;
        left: 10px;
      }

      #affichage_glissiere_poids_entree2_nc1 {
        position:absolute;
        top: 75px;
        left: 157px;
      }

      #infobulle_glissiere_poids_entree2_nc1 {
        position: absolute;
        top: 103px;
        left: 135px;
        z-index: 99;
      }

      #glissiere_poids_entree1_nc2 {
        position: absolute;
        width: 135px;  
        top: 70px;
        left: -105px;
      }

      #affichage_glissiere_poids_entree1_nc2 {
        position: absolute;
        top: 72px;
        left: 44px;
      }

      #infobulle_glissiere_poids_entree1_nc2 {
        position: absolute;
        top: 200px;
        left: 250px;
      }

      #glissiere_poids_entree2_nc2 {
        position:absolute;
        width: 135px;  
        top: 66px;
        left: -116px;
      }

      #affichage_glissiere_poids_entree2_nc2 {
        position:absolute;
        top: 71px;
        left: -153px;
      }

      #infobulle_glissiere_poids_entree2_nc2 {
        position: absolute;
        top: 270px;
        left: 260px;
     }

/* biais neurone caché 2 */

      #infobulle_biais_nc2 {
        position: absolute;
        top: 340px;
        left: 30px;
      }

      #biais_nc2 {
        position: absolute;
        height:30px;
        width:30px;
        top: 54px;
        left:-40px;
      }

      #affichage_entree_biais_nc2_0 {
        position:absolute;
        color:#d1d1d1;
        top: 402px;
        left: 60px;
      }

      #entree_biais_nc2_0 {
        position:absolute;
        top: 402px;
        left: 70px;
      }

      #affichage_entree_biais_nc2_1 {
        position:absolute;
        color:#d1d1d1;
        top: 430px;
        left: 60px;
      }

      #entree_biais_nc2_1 {
        position:absolute;
        top: 430px;
        left: 70px;
      }

      #glissiere_poids_biais_nc2 {
        position:absolute;
        width: 135px;  
        top: 96px;
        left: -35px;
      }

      #affichage_glissiere_poids_biais_nc2 {
        position:absolute;
        top: 95px;
        left: 112px;
      }

      #infobulle_glissiere_poids_biais_nc2 {
        position: absolute;
        top: 320px;
        left:180px;
     }

/* biais neurone de sortie */

      #infobulle_biais_ns {
        position: absolute;
        top: 140px;
        left:500px;
      }

      #biais_ns {
        position: absolute;
        height:30px;
        width:30px;
        top: 60px;
        left:-50px;
      }

      #affichage_entree_biais_ns_0 {
        position:absolute;
        color:#d1d1d1;
        top: 210px;
        left: 520px;
      }

      #entree_biais_ns_0 {
        position:absolute;
        top: 210px;
        left: 530px;
      }

      #affichage_entree_biais_ns_1 {
        position:absolute;
        color:#d1d1d1;
        top: 238px;
        left: 520px;
      }

      #entree_biais_ns_1 {
        position:absolute;
        top: 238px;
        left: 530px;
      }

      #glissiere_poids_biais_ns {
        position:absolute;
        width: 135px;  
        top: 72px;
        left: 0px;
      }

      #affichage_glissiere_poids_biais_ns {
        position:absolute;
        top: 74px;
        left: 148px;
      }

      #infobulle_glissiere_poids_biais_ns {
        position: absolute;
        top: 150px;
        left:600px;
      }

/* Entrées neurone de sortie */

      #glissiere_poids_entree1_ns {
        position:absolute;
        width: 135px;  
        top: 80px;
        left: 0px;
      }

      #affichage_glissiere_poids_entree1_ns {
        position:absolute;
        top: 82px;
        left: 150px;
      }

      #infobulle_glissiere_poids_entree1_ns {
        position: absolute;
        top: 70px;
        left:600px;
      }

      #glissiere_poids_entree2_ns {
        position:absolute;
        width: 135px;  
        top: 58px;
        left: -78px;
      }

      #affichage_glissiere_poids_entree2_ns {
        position:absolute;
        top: 60px;
        left: 74px;
      }

      #infobulle_glissiere_poids_entree2_ns {
        position: absolute;
        top: 230px;
        left:680px;
      }

/* ----- */

      #somme_ponderee {
        font-weight: bold;
        font-size: 150%;
        margin-left:160px;            
      }

      #activation {
        font-weight: bold;
        font-size: 150%;
        margin-left:25px;           
      }
    
      #sortie_du_neurone {
        font-weight: bold;
        font-size: 150%;
        margin-left:200px;            
      }

      #calcul_neurone {
        margin-left: 180px;
        font-weight: bold;
        font-size: 150%;      
      }

      #calcul_neurone_2 {
        margin-left: 210px;
        font-weight: bold;
        font-size: 150%;      
      }

      #image_fond_neurone_sommation {
        padding-bottom:50px;
        margin-right:0px;
        border-right:0px;
        padding-right:0px;      
      }

      #image_bouton_sommation {
        width:100px;
        height:100px;
      }

      #bouton_sommation {
        width:100px;
        height:100px;
        margin-left:0px;
        border-left:0px;
          padding-left:0px;     
        position:relative;
        left:-118px;
        bottom:104px;
      }
      
      #image_fond_neurone_activation {
        padding-bottom:50px;
        margin-right:0px;
        border-right:0px;
          padding-right:0px;      
        position:relative;
        left:-108px;
      }

      #image_bouton_activation {  
      } 

      #bouton_activation {
        width:100px;
        height:100px;
          border-radius: 10px;
        margin-left: 0px;
        border-left: 0px;
          padding-left: 0px;
        position:relative;
        left:-242px; 
              bottom:104px;
      } 

      .bouton_sortie {
        border:none;
        margin-left: 0px;
        border-left: 0px;
          padding-left: 0px;
      }   

      #image_fleche_sortie {
        position:relative;
        width:150px;
        bottom:140px;
        left:-210px;
      }

      #image_sortie_activation {
        position:relative; 
        bottom:130px;
        left:-210px;
        height:50px;
      }

      .menu_deroulant_infobulle {
        /* text-align: center; */
        position: relative;
        margin-left:12px;
        /* border: 4px solid;*/
        border-radius: 10px;
        /* border-color: #3D85C6; */
        color:red; 
        /* background-color: #CFE2F3FF; */
      }

      #affichage_activation {
        font-weight: bold;
        font-size: 200%;
        position:relative; 
        bottom:146px;
        left:-215px;
      }

      #declenchement {
        position: absolute;
        width:50px;
        top:-20px;
        left:380px;
        visibility:hidden;
      }

      /*  https://www.w3schools.com/howto/howto_custom_select.asp */

      /*the container must be positioned relative:*/
      .menu_deroulant {
        position: relative;
        font-family: Arial;
        /* Modif */
        margin-left: 350px;
        width: 150px;
        border-radius: 10px;
      }

      .menu_deroulant select {
        display: none; /*hide original SELECT element:*/
      }

      .select-selected {
        /* Modif */
        /* background-color: DodgerBlue; */
        background-color: #CFE2F3FF;
      }

      /*style the arrow inside the select element:*/
      .select-selected:after {
        position: absolute;
        content: "";
        /* top: 14px; */
        right: 10px;
        width: 0;
        height: 0;
        border: 6px solid transparent;
        /* border-color: #fff transparent transparent transparent; */
        border-color: #000000 transparent transparent transparent;
      }

      /*point the arrow upwards when the select box is open (active):*/
      .select-selected.select-arrow-active:after {
        border-color: transparent transparent #fff transparent;
        top: 7px;
      }

      /*style the items (options), including the selected item:*/
      .select-items div,.select-selected {
        /* Modif */
        /* color: #ffffff; */
        color: red;
        padding: 8px 16px;
        /* Modif */
        /* border: 1px solid transparent; */
        border: 4px solid transparent;
        border-radius: 10px;

        /* Modif */
        /* border-color: transparent transparent rgba(0, 0, 0, 0.1) transparent; */
        border-color: #3D85C6;
        cursor: pointer;
        user-select: none;
        /* Modif */
        background-color: #CFE2F3FF;
      }

      /*style items (options):*/
      .select-items {
        position: absolute;
        /* Modif */
        /* background-color: DodgerBlue; */
        background-color: #CFE2F3FF;      
        top: 100%;
        left: 0;
        right: 0;
        z-index: 99;
      }

      /*hide the items when the select box is closed:*/
      .select-hide {
        display: none;
      }

      .select-items div:hover, .same-as-selected {
        background-color: rgba(0, 0, 0, 0.1);
      }   

      #afficheur_calcul_du_neurone {
        border: 4px solid;
        border-radius: 10px 10px 10px 10px;
        border-color: #3D85C6;
        height: 125px;
        margin-top: 5px;
      }

      #titre_afficheur {
        background-color: white;
        font-weight: bold;
        font-size: 100%;
        padding-top: 5px;
        /* padding-bottom: 5px; */
      }

      #afficheur_parametres_simulation {
        border: 4px solid;
        border-radius: 10px 10px 10px 10px;
        border-color: #3D85C6;
        height: 185px;
        margin-top: 5px;
      }

      #affichage_du_calcul{
        height:auto;
        width:auto;
      }

      .contenant_glissiere {
         z-index: -1;

        /* bottom:22px; */
      }

      .glissiere_entree {
        -webkit-appearance: none;
        /* width: 100%; */
        width: 150px;
        height: 15px;
        border-radius: 5px; 
        border: 1px solid;
        border-color: #3D85C6;
        /* background: #d3d3d3; */
        background: #CFE2F3FF;
        outline: none;
        /* opacity: 0.7; */
        -webkit-transition: .2s;
        /* transition: opacity .2s; */
      }

      .glissiere_entree::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        /* width: 23px; */
        width: 76px;
        /* height: 24px; */
        height: 59px;
        border: 0;
        background: url("https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@entree.png");
        cursor: pointer;
      }

      .glissiere_entree::-moz-range-thumb {
        /* width: 23px; */
          width: 76x;
          /* height: 24px; */
          height: 59px;
          border: 0;
          background: url("https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@entree.png");
          cursor: pointer;
      }

      .glissiere_entree::-ms-thumb {
        /* width: 23px; */
          width: 76x;
          /* height: 24px; */
          height: 59px;
          border: 0;
          /* Icons made by Freepik - https://www.flaticon.com/authors/freepik */
          background: url("https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@ponderation.png");
          cursor: pointer;
      }

      .glissiere_poids {
          -webkit-appearance: none;
          /* width: 100%; */
        width: 150px;
          height: 15px;
          border-radius: 5px; 
          border: 1px solid;
          border-color: #3D85C6;
        /* background: #d3d3d3; */
        background: #CFE2F3FF;
          outline: none;
          /* opacity: 0.7; */
          -webkit-transition: .2s;
          /* transition: opacity .2s; */
      }

      .glissiere_poids::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        /* width: 23px; */
        width: 62px;
        /* height: 24px; */
        height: 62px;
        border: 0;
          /* Icons made by Freepik - https://www.flaticon.com/authors/freepik */
        background: url("https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@ponderation.png");
        cursor: pointer;
      }

      .glissiere_poids::-moz-range-thumb {
        /* width: 23px; */
          width: 62x;
          /* height: 24px; */
          height: 62px;
          border: 0;
          /* Icons made by Freepik - https://www.flaticon.com/authors/freepik */
          background: url("https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@ponderation.png");
          cursor: pointer;
      }

      .glissiere_poids::-ms-thumb {
        /* width: 23px; */
          width: 62x;
          /* height: 24px; */
          height: 62px;
          border: 0;
          /* Icons made by Freepik - https://www.flaticon.com/authors/freepik */
          background: url("https://cours.edulib.org/asset-v1:Cegep-Matane+VAERN.1FR+P2021+type@asset+block@ponderation.png");
          cursor: pointer;
      }

      /* https://www.w3schools.com/howto/howto_css_tooltip.asp */

      .infobulle {
        display: inline-block;
      }

      .infobulle .infobulletexte {
          visibility: hidden;
          width: 120px;
          background-color: black;
          color: #fff;
          text-align: center;
          border-radius: 6px;
          padding: 5px 0;
          /* Position the infobulle */
          position: absolute;
          z-index: 1;
      }

      .infobulle:hover .infobulletexte {
          visibility: visible;
      }

      #tab_simulateur {
        min-width: 1580px;
          max-width: 1580px;
      }

      #tab_exercices {
        min-width: 1580px;
          max-width: 1580px;
      }

      .titre_exercice {
        font-size: 150%;
        font-weight: bold;  
      }

      /* Style the tab */
      /* https://www.w3schools.com/howto/howto_js_tabs.asp */
      .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
      }

      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
      }

      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #ddd;
      }

      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #CFE2F3FF;
      }

      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
      }

      #bouton_suivant {
        background-color: #CFE2F3FF;
        border: 4px solid #3D85C6;
        border-radius: 5px;
        font-size: 20px;
      }

      #bouton_demarrer {
        margin-left: 50px;
        background-color: #CFE2F3FF;
        border: 4px solid #3D85C6;
        border-radius: 5px;
        font-size: 20px;
      }

      #bouton_demarrer:active {
        margin-left: 50px;
        box-shadow: 0 0 0 black;
        background-color:#3D85C6;
      }

      .parent {
        display: flex;
        flex-direction: row;
        position: relative;
        top: 0;
        left: 0;
      }

      .choix_fonction_logique {
      }

    </style>

  </body>
</html>